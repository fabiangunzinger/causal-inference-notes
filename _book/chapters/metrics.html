<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Causal inference notes - 7&nbsp; Metrics</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../chapters/references.html" rel="next">
<link href="../chapters/end_to_end_example.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../chapters/metrics.html"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metrics</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Causal inference notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">index.html</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/stats_foundations.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Statistics foundation</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/neyman_rubin_causal_model.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Neyman-Rubin causal model</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/fisher.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Fisher’s exact P-value approach</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/neyman.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Neyman’s repeated sampling approach</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/end_to_end_example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">End-to-end example</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/metrics.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metrics</span></span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../chapters/references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">References</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-good-metrics-matter" id="toc-why-good-metrics-matter" class="nav-link active" data-scroll-target="#why-good-metrics-matter"><span class="header-section-number">7.1</span> Why good metrics matter</a></li>
  <li><a href="#metric-taxonomy" id="toc-metric-taxonomy" class="nav-link" data-scroll-target="#metric-taxonomy"><span class="header-section-number">7.2</span> Metric taxonomy</a>
  <ul class="collapse">
  <li><a href="#goal-metrics" id="toc-goal-metrics" class="nav-link" data-scroll-target="#goal-metrics"><span class="header-section-number">7.2.1</span> Goal metrics</a></li>
  <li><a href="#driver-metrics" id="toc-driver-metrics" class="nav-link" data-scroll-target="#driver-metrics"><span class="header-section-number">7.2.2</span> Driver metrics</a></li>
  <li><a href="#guardrail-metrics" id="toc-guardrail-metrics" class="nav-link" data-scroll-target="#guardrail-metrics"><span class="header-section-number">7.2.3</span> Guardrail metrics</a></li>
  <li><a href="#other-metrics" id="toc-other-metrics" class="nav-link" data-scroll-target="#other-metrics"><span class="header-section-number">7.2.4</span> Other metrics</a></li>
  <li><a href="#metrics-at-different-levels-of-the-organisation" id="toc-metrics-at-different-levels-of-the-organisation" class="nav-link" data-scroll-target="#metrics-at-different-levels-of-the-organisation"><span class="header-section-number">7.2.5</span> Metrics at different levels of the organisation</a></li>
  </ul></li>
  <li><a href="#what-makes-a-good-metric" id="toc-what-makes-a-good-metric" class="nav-link" data-scroll-target="#what-makes-a-good-metric"><span class="header-section-number">7.3</span> What makes a good Metric</a>
  <ul class="collapse">
  <li><a href="#stedii" id="toc-stedii" class="nav-link" data-scroll-target="#stedii"><span class="header-section-number">7.3.1</span> STEDII</a></li>
  <li><a href="#other-characteristics" id="toc-other-characteristics" class="nav-link" data-scroll-target="#other-characteristics"><span class="header-section-number">7.3.2</span> Other characteristics</a></li>
  <li><a href="#different-priorities-for-different-metric-types" id="toc-different-priorities-for-different-metric-types" class="nav-link" data-scroll-target="#different-priorities-for-different-metric-types"><span class="header-section-number">7.3.3</span> Different priorities for different metric types</a></li>
  </ul></li>
  <li><a href="#developing-and-evaluating-good-metrics" id="toc-developing-and-evaluating-good-metrics" class="nav-link" data-scroll-target="#developing-and-evaluating-good-metrics"><span class="header-section-number">7.4</span> Developing and evaluating good metrics</a></li>
  <li><a href="#combining-metrics-into-a-signal-creating-an-oec" id="toc-combining-metrics-into-a-signal-creating-an-oec" class="nav-link" data-scroll-target="#combining-metrics-into-a-signal-creating-an-oec"><span class="header-section-number">7.5</span> Combining metrics into a signal / creating an OEC</a></li>
  <li><a href="#understanding-metric-sensitivity" id="toc-understanding-metric-sensitivity" class="nav-link" data-scroll-target="#understanding-metric-sensitivity"><span class="header-section-number">7.6</span> Understanding metric sensitivity</a></li>
  <li><a href="#how-to-select-metrics" id="toc-how-to-select-metrics" class="nav-link" data-scroll-target="#how-to-select-metrics"><span class="header-section-number">7.7</span> How to select metrics</a></li>
  <li><a href="#frameworks-for-creating-driver-metrics" id="toc-frameworks-for-creating-driver-metrics" class="nav-link" data-scroll-target="#frameworks-for-creating-driver-metrics"><span class="header-section-number">7.8</span> Frameworks for creating driver metrics</a>
  <ul class="collapse">
  <li><a href="#pirate-metrics-aarrr" id="toc-pirate-metrics-aarrr" class="nav-link" data-scroll-target="#pirate-metrics-aarrr"><span class="header-section-number">7.8.1</span> Pirate metrics (AARRR)</a></li>
  <li><a href="#aaaerrr" id="toc-aaaerrr" class="nav-link" data-scroll-target="#aaaerrr"><span class="header-section-number">7.8.2</span> AAAERRR</a></li>
  <li><a href="#pulse" id="toc-pulse" class="nav-link" data-scroll-target="#pulse"><span class="header-section-number">7.8.3</span> PULSE</a></li>
  <li><a href="#heart" id="toc-heart" class="nav-link" data-scroll-target="#heart"><span class="header-section-number">7.8.4</span> HEART</a></li>
  </ul></li>
  <li><a href="#common-metrics" id="toc-common-metrics" class="nav-link" data-scroll-target="#common-metrics"><span class="header-section-number">7.9</span> Common metrics</a></li>
  <li><a href="#ways-to-think-about-metrics" id="toc-ways-to-think-about-metrics" class="nav-link" data-scroll-target="#ways-to-think-about-metrics"><span class="header-section-number">7.10</span> Ways to think about Metrics</a></li>
  <li><a href="#other-metric-taxonomies" id="toc-other-metric-taxonomies" class="nav-link" data-scroll-target="#other-metric-taxonomies"><span class="header-section-number">7.11</span> Other metric taxonomies</a></li>
  <li><a href="#case-study-meta" id="toc-case-study-meta" class="nav-link" data-scroll-target="#case-study-meta"><span class="header-section-number">7.12</span> Case study: Meta</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span id="sec-metrics" class="quarto-section-identifier"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Metrics</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<section id="why-good-metrics-matter" class="level2" data-number="7.1">
<h2 data-number="7.1" class="anchored" data-anchor-id="why-good-metrics-matter"><span class="header-section-number">7.1</span> Why good metrics matter</h2>
<ul>
<li><p>Good metrics ensure that everyone works towards the same goal in a way that is reliable, transparent, and provides accountability – they ensure coherence across the company.</p></li>
<li><p>Good metrics increase the probability that our evaluations detect a change if there is one – they have high sensitivity.</p></li>
</ul>
</section>
<section id="metric-taxonomy" class="level2" data-number="7.2">
<h2 data-number="7.2" class="anchored" data-anchor-id="metric-taxonomy"><span class="header-section-number">7.2</span> Metric taxonomy</h2>
<p>Different contributions in the literature and different companies use different ways to classify metrics. So so the same type of metrics will have different names and the same name will be used for different types of metrics across contexts. What matters is less the labels, but an understanding of the different functions metric can serve and how different types of metric relate to one another.</p>
<p><span class="citation" data-cites="kohavi2020trustworthy">Kohavi, Tang, and Xu (<a href="references.html#ref-kohavi2020trustworthy" role="doc-biblioref">2020</a>)</span> classify metrics into goal metrics, driver metrics, and guardrail metrics. I find this useful and use it as the basis of how I think about metrics.</p>
<section id="goal-metrics" class="level3" data-number="7.2.1">
<h3 data-number="7.2.1" class="anchored" data-anchor-id="goal-metrics"><span class="header-section-number">7.2.1</span> Goal metrics</h3>
<ul>
<li><p>Also “success metrics” or “North Star” metrics</p></li>
<li><p>Directly aligned with the organisation’s mission and represents how it creates value for its customers</p></li>
<li><p>They are a quantitative definition of what success looks like</p></li>
<li><p>Tend to be long-term oriented and slow-moving</p></li>
<li><p>An organisation usually has only very few or even just one</p></li>
<li><p>Examples: “average monthly purchases” for Amazon.</p></li>
</ul>
</section>
<section id="driver-metrics" class="level3" data-number="7.2.2">
<h3 data-number="7.2.2" class="anchored" data-anchor-id="driver-metrics"><span class="header-section-number">7.2.2</span> Driver metrics</h3>
<ul>
<li><p>Also “surrogate metrics”, “predictive metrics”</p></li>
<li><p>Capture the movement of factors contributing to the organisation’s goal</p></li>
<li><p>They are a quantitative representation of what drives success</p></li>
<li><p>They tend to be short-term oriented and fast-moving</p></li>
<li><p>Will change over time as the service matures and as it becomes more closely aligned/correlated with the North Star</p></li>
<li><p>Example for Amazon buyer focused team: number of high-quality sellers that join platform per month.</p></li>
</ul>
</section>
<section id="guardrail-metrics" class="level3" data-number="7.2.3">
<h3 data-number="7.2.3" class="anchored" data-anchor-id="guardrail-metrics"><span class="header-section-number">7.2.3</span> Guardrail metrics</h3>
<ul>
<li><p><span class="citation" data-cites="kohavi2020trustworthy">Kohavi, Tang, and Xu (<a href="references.html#ref-kohavi2020trustworthy" role="doc-biblioref">2020</a>)</span> divide guardrails into two types: those protecting the business and those ensuring internal validity of experiment results</p></li>
<li><p>The main guardrail to ensure internal validity is smaple ratio mismatch (SRM). Others are discussed in chapter 21 in <span class="citation" data-cites="kohavi2020trustworthy">Kohavi, Tang, and Xu (<a href="references.html#ref-kohavi2020trustworthy" role="doc-biblioref">2020</a>)</span></p></li>
<li><p>Guardrails that protect the business ensure that improving one part of the platform don’t come at the cost of quality/experience/something else – they basically try to guard against unintended consequences</p></li>
<li><p><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> argue that the main feature of a good guardrail metric should be directionality, so that we can be sure that if we get a signal, it points in the right direction in terms of user experience (in contrast to debug metrics, which should have good sensitivity)</p></li>
<li><p>Amazon example: average number of purchases per day (to check that influx of sellers doesn’t lead to paralysis for buysers)</p></li>
</ul>
</section>
<section id="other-metrics" class="level3" data-number="7.2.4">
<h3 data-number="7.2.4" class="anchored" data-anchor-id="other-metrics"><span class="header-section-number">7.2.4</span> Other metrics</h3>
<p><strong>Supporting metrics</strong></p>
<ul>
<li><p>Indicators that the primary or NS metric are moving in the right direction (particularly useful as leading indicators)</p></li>
<li><p>Amazon example: emails sent to high-quality sellers, emails opened, etc.</p></li>
</ul>
<p><strong>Debug metrics</strong>:</p>
<ul>
<li><p><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> mention debug metrics as a way to get additional informaiton about the movement of our primary metrics.</p></li>
<li><p>They can be useful when showing the individual components of combo metrics, or the numerator and denominator of ratio metrics.</p></li>
</ul>
</section>
<section id="metrics-at-different-levels-of-the-organisation" class="level3" data-number="7.2.5">
<h3 data-number="7.2.5" class="anchored" data-anchor-id="metrics-at-different-levels-of-the-organisation"><span class="header-section-number">7.2.5</span> Metrics at different levels of the organisation</h3>
<ul>
<li><p>Above, I have defined goal, driver, and guardrail metrics in reference to the organisation.</p></li>
<li><p>But they can be defined at each level within an organisation, too.</p></li>
<li><p>The challenge is to make sure that definitions across metric types and organisation levels cohere.</p></li>
<li><p>Figure 6.1 in <span class="citation" data-cites="kohavi2020trustworthy">Kohavi, Tang, and Xu (<a href="references.html#ref-kohavi2020trustworthy" role="doc-biblioref">2020</a>)</span> is a useful way to visualise this: it shows a large arrow containing many small arrows inside. This can represent goal metrics (large arrow) and driver metrics (small arrows) or organisational metrics (large arrows) and team metrics (small arrows). In each case, we want to make sure that the direction of the small arrows is as aligned as possible with the large arrow.</p></li>
</ul>
</section>
</section>
<section id="what-makes-a-good-metric" class="level2" data-number="7.3">
<h2 data-number="7.3" class="anchored" data-anchor-id="what-makes-a-good-metric"><span class="header-section-number">7.3</span> What makes a good Metric</h2>
<section id="stedii" class="level3" data-number="7.3.1">
<h3 data-number="7.3.1" class="anchored" data-anchor-id="stedii"><span class="header-section-number">7.3.1</span> STEDII</h3>
</section>
<section id="other-characteristics" class="level3" data-number="7.3.2">
<h3 data-number="7.3.2" class="anchored" data-anchor-id="other-characteristics"><span class="header-section-number">7.3.2</span> Other characteristics</h3>
<ul>
<li><p>Meaningful (reflect goals of company, product)</p></li>
<li><p>Measurable ()</p></li>
<li><p>Moveable (with low delay)</p></li>
<li><p>Interpretable (not too complicated, easy to communicate and understand)</p></li>
<li><p>Not gameable (violate Goodhart’s law)</p></li>
</ul>
</section>
<section id="different-priorities-for-different-metric-types" class="level3" data-number="7.3.3">
<h3 data-number="7.3.3" class="anchored" data-anchor-id="different-priorities-for-different-metric-types"><span class="header-section-number">7.3.3</span> Different priorities for different metric types</h3>
<ul>
<li><p><span class="citation" data-cites="kohavi2020trustworthy">Kohavi, Tang, and Xu (<a href="references.html#ref-kohavi2020trustworthy" role="doc-biblioref">2020</a>)</span></p>
<ul>
<li>For goals: simple and stable</li>
<li>For drivers: aligned with goal, actionable and relevant, sensitive, resistant to gaming</li>
</ul></li>
</ul>
</section>
</section>
<section id="developing-and-evaluating-good-metrics" class="level2" data-number="7.4">
<h2 data-number="7.4" class="anchored" data-anchor-id="developing-and-evaluating-good-metrics"><span class="header-section-number">7.4</span> Developing and evaluating good metrics</h2>
<ul>
<li><p><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> suggest a three-step process to develop user-behaviour-driven metrics:</p>
<ol type="1">
<li><p>Formulate a hypothesis based on a simple model of user behaviour (e.g.&nbsp;social network users who like, comment, and share more have a better user-experience)</p></li>
<li><p>Conduct user studies to create labelled data against which the original model can be tested (e.g.&nbsp;conduct user surveys and test whether users who like, comment, and share more report a better experience)</p></li>
<li><p>Design online metrics based on insights from step 2 and assess their directionality and sensitivity as discussed below (e.g.&nbsp;create a metric called “meaningful engagement” and test whether it has high directionality and sensitivity in past experiments)</p></li>
</ol>
<p>In doing this, remember to 1) focus on behaviour patterns that are observed for most users, 2) collect labelled data from various sources to mitigate bias (surveys, lab studies, annotated logged data), and 3) use transparent models so that we can define and track debug metrics (e.g.&nbsp;create an online metric using a decision tree, rather than a complex ML model).</p></li>
<li><p><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> recommend using two criteria to evaluate the quality of a metric: directionality and sensitivity. Directionality requires that a move of the metric in one direction consistently captures the direction of the user experience. In practice, the direction of a metric, such as queries per user can be ambiguous. Sensitivity requires that the metric picks up changes in the user experience such that we can identify it as part of an experiment. We can think of them as the direction and the size of a vector: the more directly it points towards the North Star, and the closer it gets, the better. These two criteria also allow us to qualitatively compare different metrics and decide which one(s) to use as our OEC.</p></li>
<li><p><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> propose two ways to evalute directionality and sensitivity. First, we can use a validation corpus: a collection of prior experiments for which we know the effect on user experience, and which we can then use to test sensitivity and directionality of our metrics. The second, if no validation corpus is available, is degeneration experiments, whereby we deliberately degenerate the user experence in a way that is acceptable and doesn’t harm long-term user experience, and then measure directionality and sensitivity of the metrics.</p></li>
<li><p><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> point out that ratio metrics (CTR or Success Query Rate) are often good candidates for OECs because they are bounded and have high sensitivity. However, they need to be interpreted carefully because a change can result from a change in the numerator, the denominator, of both, out of which only the first gives a clear signal. Hence, when relying on ratio metrics, they recommend two things: 1) rely on debug metrics to separately track numerator and denominator, 2) only rely on ratio metrics with a stable denominator. For example: Bing used Session Success Rate instead or Query Success Rate even though QSR was more sensitive because the denominator of SSR was more stable (QSR was used as a debug metric).</p></li>
<li><p>For cases where no single metric fits all scenarios, <span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> recommend using a combo metric. To create such a metric, it is important to 1) understand the direction and interpretation of each metric and be aware of the scenarios when it fails to provide an accurate signal, 2) have metrics that cover all scenarios.</p></li>
<li><p>Overall process</p>
<ul>
<li>Define Goals for feature (e.g.&nbsp;improve efficiency)</li>
<li>Define Signals (fewer undos or erases)</li>
<li>Define Metrics (average number of undos per session)</li>
</ul></li>
</ul>
</section>
<section id="combining-metrics-into-a-signal-creating-an-oec" class="level2" data-number="7.5">
<h2 data-number="7.5" class="anchored" data-anchor-id="combining-metrics-into-a-signal-creating-an-oec"><span class="header-section-number">7.5</span> Combining metrics into a signal / creating an OEC</h2>
</section>
<section id="understanding-metric-sensitivity" class="level2" data-number="7.6">
<h2 data-number="7.6" class="anchored" data-anchor-id="understanding-metric-sensitivity"><span class="header-section-number">7.6</span> Understanding metric sensitivity</h2>
<ul>
<li><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> point out that detecting a treatment effect has two components:</li>
</ul>
<p><span class="math display">\[
P(\text{detecting treatment effect on the metric}) = P(H_1) \times P(p \leq \alpha | H_1)
\]</span></p>
<ul>
<li><p><span class="math inline">\(P(H_1)\)</span> is the probability the movement probability – the probability that the metric moves</p></li>
<li><p><span class="math inline">\(P(p \leq \alpha | H_1)\)</span> is power</p></li>
<li><p>The authors point out that understanding which component produces a lack of sensitivity is crucial. Because if it’s movement probability, we might need a different metric, whereas with a lack of power, variance reduction might help.</p></li>
<li><p>Examples for metrics with low movement probability might be “number of sessions per user” for a search engine, since daily search needs are limited, and changing user engagement is difficult in the short-term. An example for a metric with low power is “Revenue per user”, due to very high variance.</p></li>
</ul>
</section>
<section id="how-to-select-metrics" class="level2" data-number="7.7">
<h2 data-number="7.7" class="anchored" data-anchor-id="how-to-select-metrics"><span class="header-section-number">7.7</span> How to select metrics</h2>
<ul>
<li><p>NSM and primary based on main company/product goal, focus on criteria above</p></li>
<li><p>Support and guardrails trickier. Use AAAERRR Framework</p></li>
<li><p>To ensure coherence across all workstreams in a company, metrics used at all levels have to contribute to the same overall goal, which is captured by the company’s North Star.</p></li>
<li><p>Primary metric something that directly captures what you wanna improve? Guardrails general health metrics you don’t want to go down (e.g.&nbsp;revenue, conversion)? Based on Kohavi anecdote below</p></li>
<li><p><span class="citation" data-cites="bojinov2020importance">Bojinov, Chen, and Liu (<a href="references.html#ref-bojinov2020importance" role="doc-biblioref">2020</a>)</span> mention that LinkedIn has four company wide success metrics and many product specific ones. So, presumably we’d use company-wide ones as guardrails. Question is, what are good product-specific metrics? Good in the sense that they have a positive impact on business-wide metrics? Can use causal inference (e.g.&nbsp;IV) to test effect (see section 2.1 in <span class="citation" data-cites="bojinov2020importance">Bojinov, Chen, and Liu (<a href="references.html#ref-bojinov2020importance" role="doc-biblioref">2020</a>)</span>)</p></li>
<li><p>Have an OEC that directly captuers what you want to measure. Selecting the wrong metric can lead to misleading results. <span class="citation" data-cites="kohavi2012trusworthy">(<a href="references.html#ref-kohavi2012trusworthy" role="doc-biblioref"><strong>kohavi2012trusworthy?</strong></a>)</span> provide a memorable example from an experiment at Bing: the experiment increased revenue by user because search results were poorer, leading users to make more searches and lead them to click on more adds. This is good in the short-term. But in the long term, users will surely get frustrated by the poorer search results. A better metric would have been one that directly captures the quality of the search results, such as sessions per user. Lesson: have an OEC that directly captures the thing you want to improve, and use higher level-metrics such as revenue as guardrails.</p></li>
<li><p>Normalise metrics by sample size. E.g. user revenue per user rather than variant-level revenue (since the latter is dependent on number of users, which can vary between variants).</p></li>
</ul>
</section>
<section id="frameworks-for-creating-driver-metrics" class="level2" data-number="7.8">
<h2 data-number="7.8" class="anchored" data-anchor-id="frameworks-for-creating-driver-metrics"><span class="header-section-number">7.8</span> Frameworks for creating driver metrics</h2>
<p>Driver metrics represent quantitative measures of the factors that drive an organisation’s success. The following frameworks help us think about those drivers of success.</p>
<section id="pirate-metrics-aarrr" class="level3" data-number="7.8.1">
<h3 data-number="7.8.1" class="anchored" data-anchor-id="pirate-metrics-aarrr"><span class="header-section-number">7.8.1</span> Pirate metrics (AARRR)</h3>
<p>Developed by Dave McClure, the pirate metrics (summary <a href="https://500hats.typepad.com/500blogs/2007/09/startup-metrics.html">here</a>, slides <a href="https://www.slideshare.net/dmc500hats/startup-metrics-for-pirates-long-version">here</a>) classify driver metrics into:</p>
<ul>
<li><p>Acquisition (the user comes to our site from various channels)</p></li>
<li><p>Activation (has a good experience on the first visit)</p></li>
<li><p>Retention (comes back to the site)</p></li>
<li><p>Referral (likes the site enough to recommend it to others)</p></li>
<li><p>Revenue (engages in a revenue generating behaviour)</p></li>
</ul>
<p>The below Table provides a useful example of possible conversion metrics and associated conversion rates.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="inputs/aarrr-example-conv-metrics.png" class="img-fluid figure-img"></p>
<figcaption class="figure-caption">AARRR example conversion metrics. Source: 500hats.typepad.com/500blogs/2007/09/startup-metrics.html</figcaption>
</figure>
</div>
</section>
<section id="aaaerrr" class="level3" data-number="7.8.2">
<h3 data-number="7.8.2" class="anchored" data-anchor-id="aaaerrr"><span class="header-section-number">7.8.2</span> AAAERRR</h3>
<p>An extension of the pirate metrics.</p>
<ul>
<li><p>Awareness (how many aware of product)</p></li>
<li><p>Acquisition (how many use product)</p></li>
<li><p>Activation (how many are realizing value of product – e.g.&nbsp;10 friends in 7 days on FB / stored at least 1 file on a device on Dropbox)</p></li>
<li><p>Engagement (breath and frequencey of engagement)</p></li>
<li><p>Revenue (how many are paying for product)</p></li>
<li><p>Retention/renewal (how many are coming back)</p></li>
<li><p>Referral (how many are becoming advocates)</p></li>
</ul>
</section>
<section id="pulse" class="level3" data-number="7.8.3">
<h3 data-number="7.8.3" class="anchored" data-anchor-id="pulse"><span class="header-section-number">7.8.3</span> PULSE</h3>
<ul>
<li><p>Page views</p></li>
<li><p>Uptime</p></li>
<li><p>Latency</p></li>
<li><p>Seven-day active users</p></li>
<li><p>Earnings</p></li>
</ul>
</section>
<section id="heart" class="level3" data-number="7.8.4">
<h3 data-number="7.8.4" class="anchored" data-anchor-id="heart"><span class="header-section-number">7.8.4</span> HEART</h3>
<ul>
<li><p>Developed by <span class="citation" data-cites="rodden2010measuring">Rodden, Hutchinson, and Fu (<a href="references.html#ref-rodden2010measuring" role="doc-biblioref">2010</a>)</span>, the authors address shortcomings of the PULSE framework.</p></li>
<li><p>Key challenge in CHI is creation of user-experience metrics based on large-scale data.</p></li>
<li><p>Traditional PULSE metrics (Page views, Uptime, Latency, Seven-day active users, Earnings) are useful and related to user-experience, but limited because they are indirect and can be ambiguous (are more page views a sign of an increase in engagement or in confusion?) and provide limited insight (seven-day active users shows user-base volume but nothing about product commitment).</p></li>
<li><p>Authors propose HEART metrics (Happiness, Engagement, Adoption, Retention, Task success) to complement traditional metrics and remedy their shortcomings.</p></li>
<li><p>Happiness</p>
<ul>
<li>Measured using bipolar scale in-product survey</li>
<li>Shows that users liked redesign of personalised homepage after initial dip (also shows value of dynamic treatment effects)</li>
</ul></li>
<li><p>Engagement</p>
<ul>
<li>E.g. number of visits per user per week</li>
<li>Helped Gmail team see proportion of users who visited more than 5 times per week.</li>
</ul></li>
<li><p>Adoption and retention</p>
<ul>
<li>E.g. how many new accounts created (adoption), how many users from seven-day active users 3 weeks ago are still in that set (retention).</li>
<li>Helped Google Finance team distinguish between new and recurring users during 2008 meltdown.</li>
</ul></li>
<li><p>Task success</p>
<ul>
<li>E.g. progress in optimal path (signup)</li>
<li>Helped Google maps team see that users could adopt search to single-box so they could drop double-box version.</li>
</ul></li>
</ul>
</section>
</section>
<section id="common-metrics" class="level2" data-number="7.9">
<h2 data-number="7.9" class="anchored" data-anchor-id="common-metrics"><span class="header-section-number">7.9</span> Common metrics</h2>
<ul>
<li>Conversion rate</li>
<li>Number of bookings</li>
<li>Engagement
<ul>
<li>Likes, shares, comments, reactions</li>
<li>Page views</li>
<li>Click-through rates (CTR)</li>
<li>Time spent per user per day</li>
</ul></li>
<li>Retention
<ul>
<li>Daily active users (DAU)</li>
<li>Churn rate (percentage of users who stop using the service within a given period)</li>
</ul></li>
<li>Revenue
<ul>
<li>Average revenue per user (ARPE)</li>
<li>Customer lifetime value (CLV)</li>
</ul></li>
</ul>
<p>Guardrail metrics - Bounce rate (proportion of site visitors who leave after seeing only the first page) - Cancellation rate -</p>
</section>
<section id="ways-to-think-about-metrics" class="level2" data-number="7.10">
<h2 data-number="7.10" class="anchored" data-anchor-id="ways-to-think-about-metrics"><span class="header-section-number">7.10</span> Ways to think about Metrics</h2>
<ul>
<li>From Meta
<ul>
<li>Topline metric: e.g.&nbsp;daily active users</li>
<li>Feature/product team northstar: e.g.&nbsp;total buyers for buyer-facing side of marketplace</li>
<li>Guardrail metric: number of messages flagges as spam or harmful in msg app</li>
</ul></li>
</ul>
</section>
<section id="other-metric-taxonomies" class="level2" data-number="7.11">
<h2 data-number="7.11" class="anchored" data-anchor-id="other-metric-taxonomies"><span class="header-section-number">7.11</span> Other metric taxonomies</h2>
<p><strong>Business report vs heuristic vs user-behaviour</strong></p>
<ul>
<li><p><span class="citation" data-cites="deng2016data">Deng and Shi (<a href="references.html#ref-deng2016data" role="doc-biblioref">2016</a>)</span> use a different classification altogether:</p>
<ul>
<li><p>Type 1: Business Report Driven Metrics: Business report driven metrics, like Revenue per User and Monthly Active Users, focus on long-term goals of online services. These metrics are vital for business assessments but are less actionable for short-term product improvements. For example, improving search results in a service like Bing might decrease short-term revenue per user, highlighting the need for longer-term experimentation to truly assess impacts.</p></li>
<li><p>Type 2: Simple Heuristic Based Metrics: Simple heuristic based metrics, such as Click-Through Rate and user activity counts, offer direct insights into user interaction with online services. While actionable, they can be misleading in terms of user experience and business goals. For instance, higher CTR due to misleading content can negatively impact user experience and, subsequently, the service’s market share. These metrics are suitable for early-stage services but may not align with real user experience improvements in more mature stages.</p></li>
<li><p>Type 3: User-Behavior-Driven Metrics: User-behavior-driven metrics, derived from user satisfaction and frustration models, aim to directly measure user experience and its impact on long-term service success. They are complex, involving detailed analysis of user behavior, like considering both clicks and dwell time for assessing search satisfaction. These metrics are sensitive and actionable for agile experiments, offering a more nuanced understanding of user interaction than simpler metrics.</p></li>
</ul></li>
</ul>
</section>
<section id="case-study-meta" class="level2" data-number="7.12">
<h2 data-number="7.12" class="anchored" data-anchor-id="case-study-meta"><span class="header-section-number">7.12</span> Case study: Meta</h2>
<p>Metrics in quarterly earnings presentation:</p>
<ul>
<li><p>Advertising revenue (by user geography) – $33bn</p></li>
<li><p>Revenue (by user geography) – $34bn</p></li>
<li><p>Net income – $11bn</p></li>
<li><p>Family daily active people (DAP) – 3.1bn</p></li>
<li><p>Family monthly active people (MAP) – 3.9bn</p></li>
<li><p>DAP / MAP – 80%</p></li>
<li><p>Family average revenue per person per quarter (ARPP) – $8.7</p></li>
<li><p>Facebook daily active users (DAU) – 2bn</p></li>
<li><p>Facebook monthly active users (MAU) – 3bn</p></li>
<li><p>DAU / MAU – 68%</p></li>
<li><p>Facebook average regenue per user (ARPU) – $11</p></li>
</ul>
<p>Definitions: - We define a daily active person (DAP) as a registered and logged-in user of Facebook, Instagram, Messenger, and/or WhatsApp (collectively, our “Family” of products) who visited at least one of these Family products through a mobile device application or using a web or mobile browser on a given day.</p>
<ul>
<li>We define average revenue per person (ARPP) as our total revenue during a given quarter, divided by the average of the number of MAP at the beginning and end of the quarter. While ARPP includes all sources of revenue, the number of MAP used in this calculation only includes users of our Family products as described in the definition of MAP in the previous slide.</li>
</ul>
<p>Limitations of key data</p>
<ul>
<li><p>The numbers for our key metrics are calculated using internal company data based on the activity of user accounts.</p></li>
<li><p>We report our estimates of the numbers of our daily active people (DAP), monthly active people (MAP), and average revenue per person (ARPP) (collectively, our “Family metrics”) based on the activity of users who visited at least one of Facebook, Instagram, Messenger, and WhatsApp (collectively, our “Family” of products) during the applicable period of measurement.</p></li>
<li><p>We have historically reported the numbers of our daily active users (DAUs), monthly active users (MAUs), and average revenue per user (ARPU) (collectively, our “Facebook metrics”) based on user activity only on Facebook and Messenger and not on our other products.</p></li>
<li><p>We believe our Family metrics better reflect the size of our community and the fact that many people are using more than one of our products. As a result, over time we intend to report our Family metrics as key metrics in place of DAUs, MAUs, and ARPU.</p></li>
<li><p>While these numbers are based on what we believe to be reasonable estimates of our user base for the applicable period of measurement, there are inherent challenges in measuring usage of our products across large online and mobile populations around the world. The methodologies used to measure these metrics require significant judgment and are also susceptible to algorithm or other technical errors. In addition, we are continually seeking to improve our estimates of our user base, and such estimates may change due to improvements or changes in our methodology. We regularly review our processes for calculating these metrics, and from time to time we discover inaccuracies in our metrics or make adjustments to improve their accuracy, which can result in adjustments to our historical metrics. Our ability to recalculate our historical metrics may be impacted by data limitations or other factors that require us to apply different methodologies for such adjustments. We generally do not intend to update previously disclosed Family metrics for any such inaccuracies or adjustments that are within the error margins disclosed below.</p></li>
<li><p>In addition, our Family metrics and Facebook metrics estimates will differ from estimates published by third parties due to differences in methodology or other factors such as data limitations or other challenges in measuring large online and mobile populations. For example, our Family metrics estimates in some instances exceed estimates of addressable online and mobile populations that are based on data published by third parties.</p></li>
</ul>
<p>Family Metrics</p>
<ul>
<li><p>Many people in our community have user accounts on more than one of our products, and some people have multiple user accounts within an individual product. Accordingly, for our Family metrics, we do not seek to count the total number of user accounts across our products because we believe that would not reflect the actual size of our community. Rather, our Family metrics represent our estimates of the number of unique people using at least one of Facebook, Instagram, Messenger, and WhatsApp.</p></li>
<li><p>We do not require people to use a common identifier or link their accounts to use multiple products in our Family, and therefore must seek to attribute multiple user accounts within and across products to individual people. To calculate these metrics, we rely upon complex techniques, algorithms and machine learning models that seek to count the individual people behind user accounts, including by matching multiple user accounts within an individual product and across multiple products when we believe they are attributable to a single person, and counting such group of accounts as one person. These techniques and models require significant judgment, are subject to data and other limitations discussed below, and inherently are subject to statistical variances and uncertainties.</p></li>
<li><p>We estimate the potential error in our Family metrics primarily based on user survey data, which itself is subject to error as well. While we expect the error margin for our Family metrics to vary from period to period, we estimate that such margin generally will be approximately 3% of our worldwide MAP.</p></li>
<li><p>At our scale, it is very difficult to attribute multiple user accounts within and across products to individual people, and it is possible that the actual numbers of unique people using our products may vary significantly from our estimates, potentially beyond our estimated error margins. As a result, it is also possible that our Family metrics may indicate changes or trends in user numbers that do not match actual changes or trends.</p></li>
<li><p>To calculate our estimates of Family DAP and MAP, we currently use a series of machine learning models that are developed based on internal reviews of limited samples of user accounts and calibrated against user survey data. We apply significant judgment in designing these models and calculating these estimates. For example, to match user accounts within individual products and across multiple products, we use data signals such as similar device information, IP addresses, and user names. We also calibrate our models against data from periodic user surveys of varying sizes and frequency across our products, which are inherently subject to error. The timing and results of such user surveys have in the past contributed, and may in the future contribute, to changes in our reported Family metrics from period to period. In addition, our data limitations may affect our understanding of certain details of our business and increase the risk of error for our Family metrics estimates. Our techniques and models rely on a variety of data signals from different products, and we rely on more limited data signals for some products compared to others. For example, as a result of limited visibility into encrypted products, we have fewer data signals from WhatsApp user accounts and primarily rely on phone numbers and device information to match WhatsApp user accounts with accounts on our other products. Similarly, although Messenger Kids users are included in our Family metrics, we do not seek to match their accounts with accounts on our other applications for purposes of calculating DAP and MAP.</p></li>
<li><p>Any loss of access to data signals we use in our process for calculating Family metrics, whether as a result of our own product decisions, actions by third-party browser or mobile platforms, regulatory or legislative requirements, or other factors, also may impact the stability or accuracy of our reported Family metrics, as well as our ability to report these metrics at all.</p></li>
<li><p>Our estimates of Family metrics also may change as our methodologies evolve, including through the application of new data signals or technologies, product changes, or other improvements in our user surveys, algorithms, or machine learning that may improve our ability to match accounts within and across our products or otherwise evaluate the broad population of our users. In addition, such evolution may allow us to identify previously undetected violating accounts (as defined below).</p></li>
<li><p>We regularly evaluate our Family metrics to estimate the percentage of our MAP consisting solely of “violating” accounts. We define “violating” accounts as accounts which we believe are intended to be used for purposes that violate our terms of service, including bots and spam. In the fourth quarter of 2022, we estimated that approximately 3% of our worldwide MAP consisted solely of violating accounts. Such estimation is based on an internal review of a limited sample of accounts, and we apply significant judgment in making this determination. For example, we look for account information and behaviors associated with Facebook and Instagram accounts that appear to be inauthentic to the reviewers, but we have limited visibility into WhatsApp user activity due to encryption. In addition, if we believe an individual person has one or more violating accounts, we do not include such person in our violating accounts estimation as long as we believe they have one account that does not constitute a violating account. From time to time, we disable certain user accounts, make product changes, or take other actions to reduce the number of violating accounts among our users, which may also reduce our DAP and MAP estimates in a particular period. We intend to disclose our estimates of the percentage of our MAP consisting solely of violating accounts on an annual basis. Violating accounts are very difficult to measure at our scale, and it is possible that the actual number of violating accounts may vary significantly from our estimates.</p></li>
<li><p>The numbers of Family DAP and MAP discussed in this presentation, as well as ARPP, do not include users on our other products, unless they would otherwise qualify as DAP or MAP, respectively, based on their other activities on our Family products.</p></li>
</ul>
<p>Facebook Metrics</p>
<ul>
<li><p>We regularly evaluate our Facebook metrics to estimate the number of “duplicate” and “false” accounts among our MAUs. A duplicate account is one that a user maintains in addition to his or her principal account. We divide “false” accounts into two categories: (1) user-misclassified accounts, where users have created personal profiles for a business, organization, or non- human entity such as a pet (such entities are permitted on Facebook using a Page rather than a personal profile under our terms of service); and (2) violating accounts, which represent user profiles that we believe are intended to be used for purposes that violate our terms of service, such as bots and spam. The estimates of duplicate and false accounts are based on an internal review of a limited sample of accounts, and we apply significant judgment in making this determination. For example, to identify duplicate accounts we use data signals such as identical IP addresses and similar user names, and to identify false accounts we look for names that appear to be fake or other behavior that appears inauthentic to the reviewers. Any loss of access to data signals we use in this process, whether as a result of our own product decisions, actions by third-party browser or mobile platforms, regulatory or legislative requirements, or other factors, also may impact the stability or accuracy of our estimates of duplicate and false accounts. Our estimates also may change as our methodologies evolve, including through the application of new data signals or technologies or product changes that may allow us to identify previously undetected duplicate or false accounts and may improve our ability to evaluate a broader population of our users. Duplicate and false accounts are very difficult to measure at our scale, and it is possible that the actual number of duplicate and false accounts may vary significantly from our estimates.</p></li>
<li><p>In the fourth quarter of 2022, we estimated that duplicate accounts may have represented approximately 11% of our worldwide MAUs. We believe the percentage of duplicate accounts is meaningfully higher in developing markets such as the Philippines and Vietnam, as compared to more developed markets. In the fourth quarter of 2022, we estimated that false accounts may have represented approximately 4-5% of our worldwide MAUs. Our estimation of false accounts can vary as a result of episodic spikes in the creation of such accounts, which we have seen originate more frequently in specific countries such as Indonesia, Nigeria, and Vietnam. From time to time, we disable certain user accounts, make product changes, or take other actions to reduce the number of duplicate or false accounts among our users, which may also reduce our DAU and MAU estimates in a particular period. We intend to disclose our estimates of the number of duplicate and false accounts among our MAUs on an annual basis.</p></li>
<li><p>The numbers of DAUs and MAUs discussed in this presentation, as well as ARPU, do not include users on Instagram, WhatsApp, or our other products, unless they would otherwise qualify as DAUs or MAUs, respectively, based on their other activities on Facebook.</p></li>
</ul>
<p>User Geography - Our data regarding the geographic location of our users is estimated based on a number of factors, such as the user’s IP address and self-disclosed location. These factors may not always accurately reflect the user’s actual location. For example, a user may appear to be accessing Facebook from the location of the proxy server that the user connects to rather than from the user’s actual location. The methodologies used to measure our metrics are also susceptible to algorithm or other technical errors, and our estimates for revenue by user location and revenue by user device are also affected by these factors.</p>


<div id="refs" class="references csl-bib-body hanging-indent" role="list" style="display: none">
<div id="ref-bojinov2020importance" class="csl-entry" role="listitem">
Bojinov, Iavor, Albert Chen, and Min Liu. 2020. <span>“The Importance of Being Causal.”</span> <em>Harvard Data Science Review</em> 2 (3): 6.
</div>
<div id="ref-deng2016data" class="csl-entry" role="listitem">
Deng, Alex, and Xiaolin Shi. 2016. <span>“Data-Driven Metric Development for Online Controlled Experiments: Seven Lessons Learned.”</span> In <em>Proceedings of the 22nd ACM SIGKDD International Conference on Knowledge Discovery and Data Mining</em>, 77–86.
</div>
<div id="ref-kohavi2020trustworthy" class="csl-entry" role="listitem">
Kohavi, Ron, Diane Tang, and Ya Xu. 2020. <em>Trustworthy Online Controlled Experiments: A Practical Guide to a/b Testing</em>. Cambridge University Press.
</div>
<div id="ref-rodden2010measuring" class="csl-entry" role="listitem">
Rodden, Kerry, Hilary Hutchinson, and Xin Fu. 2010. <span>“Measuring the User Experience on a Large Scale: User-Centered Metrics for Web Applications.”</span> In <em>Proceedings of the SIGCHI Conference on Human Factors in Computing Systems</em>, 2395–98.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../chapters/end_to_end_example.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">End-to-end example</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../chapters/references.html" class="pagination-link">
        <span class="nav-page-text">References</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>